####$bzoj1009-HNOI2008$ $GT$考试

* 题面描述

  * 阿申准备报名参加$GT$考试，准考证号为$N$位数$x_1,x_2,...,x_n\ (0\leq x_i\leq 9)$，他不希望准考证号上出现不吉利的数字。
    他的不吉利数字$a_1,a_2,...,a_m\ (0\leq a_i\leq 9)$有$M$位，不出现是指$x_1,x_2,...,x_n$中没有恰好一段等于$a_1,a_2,...,a_m$。 $a_1$和$x_1$可以为
    $0$

* 输入格式

  * 第一行输入$N,M,K$。接下来一行输入$M$位的数。 $N\leq 10^9,M\leq 20,K\leq 1000$

* 输出格式

  * 阿申想知道不出现不吉利数字的号码有多少种，输出模$K$取余的结果。

* 题解

  * 首先，看到题意是在一定条件下统计 位数$\leq N$的数 的个数，第一反应数位$dp$。题目对要统计的数的要求是 这个数不能与模式串（不吉利数字）匹配。我们回忆$KMP$过程，当原串与模式串在某一位失配时，我们将模式串指针$x$通过$next_x$不断回跳，直到能够与原串匹配。

  * 类似的，当我们按照数位$dp$的阶段，在后面加上$0-9$中的数字$x$时，我们同样通过$next_x$匹配，再在尾部加上数字$x$。

  * 因此我们可以设计出这样的$dp$方程。令$f_{i,j}$表示前$i$位匹配到模式串的第$j$位的方案数，令$pre_{i,0..9}$表示通过$next_i$对于在第$i$位后加上数字$0\leq x\leq 9$匹配到模式串的第$pre_{i,x}$位。

  * $$
    f_{i,pre_{j,x}}+=f_{i-1,j}\ (0\leq j<m,0\leq x\leq 9)
    $$

  * 这样我们得到了一个时间复杂度为$O(nm)$的~~优秀算法~~。

  * 再看一眼范围$n\leq 10^9$！！这样我们就只能用加速**线性递推式**的神器<font color="red">矩阵快速幂</font>。将递推式写成矩阵的形式，用矩阵快速幂.....~~（感觉根本不会讲）~~



