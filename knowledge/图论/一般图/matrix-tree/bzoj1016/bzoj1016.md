#### $bzoj1016-JSOI2008$ 最小生成树计数

* 题面描述
  * 现在给出了一个简单无向加权图。你不满足于求出这个图的最小生成树，而希望知道这个图中有多少个不同的最小生成树。（如果两颗最小生成树中至少有一条边不同，则这两个最小生成树就是不同的）。由于不同的最小生成树可能很多，所以你只需要输出方案数对$31011$的模就可以了。
* 输入格式
  * 第一行包含两个数，$n$和$m$，其中$1\leq n\leq 10^2, 1\leq m\leq 10^3$ 表示该无向图的节点数和边数。每个节点用$[1,n]$的整数编号。接下来的$m$行，每行包含两个整数：$a, b, c$，表示节点$a, b$之间的边的权值为$c$，其中$1\leq c\leq 10^9$。数据保证不会出现自回边和重边。
  * 注意：具有相同权值的边不会超过$10$条。
* 输出格式
  * 输出不同的最小生成树有多少个。你只需要输出数量对$31011$的模就可以了。
* 题解
  * 引理
    * 对于一张给定的无向图，权值相同的边在该无向图的最小生成树中数量相同，连接的集合相同（作用相同）
      * 证明：（数学归纳法）
        * 假设$kruskal$过程中当加入完一种权值的边，要加入下一种权值$x$的边时，对于权值为$x$的边所面对的集合相同。因为集合相同，故加入的边数相同。
        * 假设加入完权值为$x$的边后集合为$S$，边数为$cnt$，权值为$x$的边加入到最小生成树的边集的集合为$in_x$，没有加入边集的集合为$out_x$。
        * 想要让$S$产生变化，有三种情况：
          * 将$e\in in_x$从$in_x$中删除加入到$out_x$。
            * 但根据$kruskal$的算法，如果$\exist e'$使得两个原本不交的点集合并成一个点集，则该边$e'$必然加入$in_x$。因此$e$不可能从$in_x$中删除。
          * 将$e\in out_x$从$out_x$中删除加入到$in_x$中。
            * 同理，如果该边能够加入$in_x$，必然已经存在于$in_x$中了，因此$\forall e\in out_x$都不可能加入$in_x$
          * 将$e_1\in in_x$从$in_x$中删除加入到$out_x$中，将$e_2\in out_x$从$out_x$中删除加入到$in_x$中。
            * 假设如此操作能够改变$S$。设$e_1$原先连接的两个点集为$S_{1,1},S_{1,2}$，$e_2$原先连接的两个点集为$S_{2,1},S_{2,2}$。
            * 如果$S_{1,1},S_{1,2}$与$S_{2,1},S_{2,2}$不相同，$e_2$想要加入$in_x$中，必然要满足$S_{2,1},S_{2,2}$两个点集在原最小生成树上是两个不同的点集，而如果是这样的话，$e_2$必然已经被加入$in_x$中，而不可能存在于$out_x$中。
            * 如果$S_{1,1},S_{1,2}$与$S_{2,1},S_{2,2}$相同，如此操作对$S$无影响。
        * 因此对于权值$x$的边加入后的$S'$，无论权值$x$的边如何取，一定全部相同
        * 证毕
  * 因此我们可以将每种不同权值的边独立开来考虑，这时就有两种想法：
    * 先做一遍完整的$kruskal$求得每种权值的边在最小生成树出现的条数。再对于权值$x$的边我通过$dfs$求得所有合法加入方案，共$cnt_x$种。再用乘法原理的$ans=\prod_{x}cnt_x\  \%mod​$
    * 在做$kruskal$时对于权值$x$的边单独考虑，将加入权值$x$的边前的图缩点，连上所有权值$x$的边，跑$matrix-tree$定理，跑出所有生成树方案$cnt_x$。再用乘法原理的$ans=\prod_{x}cnt_x\  \%mod$
      * 注意：将权值$x$的边连进$matrix-tree$的$mat$中后，这个缩过点的图<font color="red">不一定连通</font>，要加一些**桥边**（ 桥边 对 生成树方案个数 无贡献）<font color="red">保证图连通</font>

