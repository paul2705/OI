####$bzoj1025-SCOI2009$游戏

* 题面描述

  * $windy​$学会了一种游戏。对于$1​$到$N​$这$N​$个数字，都有唯一且不同的1到N的数字与之对应。最开始$windy​$把数字按顺序$1,2,3,\cdots,N​$写一排在纸上。然后再在这一排下面写上它们对应的数字。然后又在新的一排下面写上它们对应的数字。如此反复，直到序列再次变为$1,2,3,\cdots,N​$。 如：$ 1\ 2\ 3\ 4\ 5\ 6​$ 对应的关系为 $1\to 2\ 2\to 3\ 3\to 1\ 4\to 5\ 5\to 4\ 6\to 6​$ ，$windy​$的操作如下：

* ```cpp 1 2 3 4 5 6 
  2 3 1 5 4 6 
  3 1 2 4 5 6 
  1 2 3 5 4 6 
  2 3 1 4 5 6 
  3 1 2 5 4 6 
  1 2 3 4 5 6 
  ```

  * 这时，我们就有若干排1到N的排列，上例中有7排。现在windy想知道，对于所有可能的对应关系，有多少种可能的排数。

* 输入格式

  * 包含一个整数N,1 <= N <= 1000

* 输出格式

  * 包含一个整数，可能的排数。

* 题解

  * 在做此题前，建议各位先行了解群论及置换概念。
  * 在了解置换的概念后，我们不难发现原题可以抽象与对于1～n的排列的所有可能置换统计通过置换回到原排列的可能不同次数。
  * 我们可以将置换写成循环节的形式，即$(a\ b\ c)(d\ e)(f)$，由循环节的性质得通过该置换回到原排列的次数为lcm（各循环节长度）。
    * 简单证明：
    * 一个循环节最后回到自己需$k*len\ (k\in N^*)$，$len$为循环节长度。
  * 让所有循环节同时回到自己需$lcm(len_1,\cdots,len_x)$，$x$为总循环节个数。
  * 现在，我们把题意转化为求所有{$a_m$}，使∑$a_i$=n，求这样的数列的$lcm(a_1,\cdots,a_m)$的不同个数。
  * 当你用当前结论做$dp$时，不难发现，你无论怎样$dp$都会重复计数。
  * 我们考虑反过来做，当我们能得到$lcm=p_i$，要使得能得到该$lcm$的和最小的数列为，即$a_i=p_i^r$。
    * 证明：可类比字符串中最小表示法，如此对于一个$p_i$，我们有唯一表示其的方法。又因为质因数分解也是唯一的，因此对于$lcm$，我们得到唯一表示其的数列。
  * 然后，问题进一步转化为找到所有以质因数为数列，且$s_n≤n$的数列个数，当$s_n<n$时余下的用长度为1的循环节代替。
  * 这样，我们对所有$p_i^1,p_i^2,\cdots,p_i^r​$做背包即可。