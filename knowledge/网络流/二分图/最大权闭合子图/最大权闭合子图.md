#### 最大权闭合子图

* 定义：在**有向图**中，选择一个点集$S\subseteq V$，$S$满足对于$\forall x\in S$ 都有 对于$\forall (x,y)\in E,y\in S$，使得$\sum a_{x}\ (x\in S)$最大
* 实现：$S​$向所有$a_x\geq0​$的点连$(S,x,a_x)​$的边，所有$a_x<0​$的点向$T​$连$(x,T,-a_x)​$的边，原图所有边容量为$+\infin​$。则 **最大权值和=正权和-最小割**
  * 证明：
    * 考虑极端条件我们可以选全部的正权点，答案一定最优，但这不可能，故需要调整。当我们割一条$(S,x)$的边 意味着我们舍弃一个正权点，当我们割一条$(x,T)$的边 意味着我们加进一个负权点。
    * 考虑$S,T$对应的实质意义，当我们割掉一条边$(S,x)$，当且仅当$x$与$T$联通，割$(x,T)$同理。最后与$S$联通的点就是我们要选的点，而最后与$T$联通的点就是我们不要的点，且不可能存在一个点$x$最后既不和$S$联通，又不和$T$联通。
  * 有了前面的思考，现在我们在讲最小割的合法性。
    * 证明：当$S,T$没有通路时所选的闭合子图合法。
    * 对于任意一个$x$与$S$联通，都不可能跟$T$联通，即不可能和与$T$联通的点相连。因此$x$的所有后继不然都包含在与$S$联通的集合中。因此与$S$联通的集合是一个合法的闭合子图。
  * 最优性：根据公式 **最大权值和=正权和-最小割**，正权和 为定值，而最小割已经最小化，故 权值和已最大